# 智能匹配分析 - 调试指南

## 问题诊断步骤

### 1. 检查前端控制台
打开浏览器开发者工具 (F12)，查看 Console 标签页：
- 点击"生成优化后的简历"按钮
- 查看是否有 console.log 输出（我们已添加详细的调试日志）
- 查看是否有错误信息

### 2. 检查网络请求
在开发者工具的 Network 标签页：
- 点击按钮后查看是否有请求发送到 `/api/v1/resume-generator/generate`
- 检查请求状态码（200 = 成功，4xx/5xx = 错误）
- 查看响应数据

### 3. 常见问题排查

#### 问题 A: 按钮被禁用（灰色）
**原因**: 没有勾选任何建议
**解决**: 
1. 确保至少勾选一条建议
2. 或点击"全部应用"按钮
3. 查看按钮下方是否有提示文字："请至少勾选一条建议后再生成简历"

#### 问题 B: 点击按钮无反应
**可能原因**:
1. JavaScript 错误 - 查看控制台
2. 事件未绑定 - 刷新页面重试
3. 按钮被其他元素遮挡 - 检查 CSS z-index

#### 问题 C: 请求发送但返回错误
**检查后端日志**:
```bash
# 查看后端终端输出
# 应该能看到请求日志和可能的错误信息
```

**常见后端错误**:
- 404: 路由未注册或路径错误
- 500: 服务器内部错误（查看后端日志）
- 422: 请求数据格式错误

### 4. 前端调试日志说明

点击"生成优化后的简历"后，控制台应该显示：

```
=== 开始生成简历 ===
当前选中的简历ID: xxx-xxx-xxx
当前选中的职位ID: yyy-yyy-yyy
所有建议: [...]
已应用的建议数量: 3
已应用的建议详情: [...]
准备发送请求到: http://localhost:8000/api/v1/resume-generator/generate
请求数据: {...}
后端响应: {...}
提取的简历内容: ...
```

### 5. 手动测试 API

使用 curl 或 Postman 测试后端接口：

```bash
curl -X POST http://localhost:8000/api/v1/resume-generator/generate \
  -H "Content-Type: application/json" \
  -d '{
    "resume_id": "你的简历ID",
    "job_id": "你的职位ID",
    "suggestions": [
      {
        "category": "项目描述",
        "content": "测试建议内容",
        "template": "测试模板"
      }
    ]
  }'
```

### 6. 快速修复建议

如果按钮完全没有反应：

1. **硬刷新页面**: Cmd+Shift+R (Mac) 或 Ctrl+Shift+R (Windows)
2. **清除缓存**: 开发者工具 -> Application -> Clear storage
3. **检查是否有建议**: 确保分析完成后有建议列表显示
4. **检查是否勾选**: 至少勾选一条建议

### 7. 代码检查点

**前端 (MatchAnalysis.tsx)**:
- Line 160-207: `handleGenerateFinalResume` 函数
- Line 381-397: 按钮定义和点击事件绑定
- Line 86: `analyzing` 状态管理

**后端 (resume_generator.py)**:
- Line 46-103: `generate_optimized_resume` 方法
- Line 561-680: `_format_resume_as_text` 方法（新增）
- Line 85: 返回 `optimized_content` 字段

**后端 API (resume_generator.py endpoints)**:
- Line 34-73: `/generate` 端点
- Line 38-56: 处理 suggestions 列表

## 预期行为

1. 用户勾选建议
2. 点击"生成优化后的简历"按钮
3. 按钮显示 loading 状态："正在生成简历..."
4. 后端处理请求（5-15秒）
5. 弹出模态框显示优化后的简历
6. 用户可以查看、复制或导出简历

## 如果仍然无法解决

请提供以下信息：
1. 浏览器控制台的完整错误信息
2. Network 标签页中的请求详情
3. 后端终端的日志输出
4. 是否有勾选建议
5. 按钮是否显示为禁用状态
